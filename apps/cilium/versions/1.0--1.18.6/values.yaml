# --- Terraform parity ---
operator:
  replicas: 2

ipam:
  mode: kubernetes

routingMode: native
ipv4NativeRoutingCIDR: 10.0.16.0/20

kubeProxyReplacement: true

bpf:
  masquerade: false

loadBalancer:
  acceleration: native

cgroup:
  autoMount:
    enabled: false
  hostRoot: /sys/fs/cgroup

# Talos kube-prism
k8sServiceHost: 127.0.0.1
k8sServicePort: 7445

# Talos-required capabilities (these match your terraform set strings)
securityContext:
  capabilities:
    ciliumAgent:
      - CHOWN
      - KILL
      - NET_ADMIN
      - NET_RAW
      - IPC_LOCK
      - SYS_ADMIN
      - SYS_RESOURCE
      - DAC_OVERRIDE
      - FOWNER
      - SETGID
      - SETUID
    cleanCiliumState:
      - NET_ADMIN
      - SYS_ADMIN
      - SYS_RESOURCE

# Terraform default (unless you enabled encryption there)
encryption:
  enabled: false
  type: wireguard

# --- Your additions ---

hubble:
  enabled: true
  relay:
    enabled: true
  ui:
    enabled: true
  metrics:
    enabled:
      - dns
      - drop
      - tcp
      - flow
      - port-distribution
      - icmp
      - http

# Monitoring via ServiceMonitors (requires Prometheus Operator CRDs present)
prometheus:
  serviceMonitor:
    enabled: true
    trustCRDsExist: true

operator:
  prometheus:
    serviceMonitor:
      enabled: true

# Cilium Ingress Controller
ingressController:
  enabled: true
  default: true
  loadbalancerMode: shared
  enforceHttps: true
  defaultSecretNamespace: kube-system
  defaultSecretName: cilium-default-cert

nodePort:
  enabled: true